<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
 <mapper namespace="com.nobanryeo.petpal.user.adopt.dao.ShareFreeMapper">
 
 	<resultMap type="ShareFreeDTO" id="sharefreeResultMap">
 		<result column="BOARD_CODE" property="boardCode"/>
 		<result column="BOARD_TITLE" property="boardTitle"/>
 		<result column="BOARD_CONTENT" property="boardContent"/>
 		<result column="BOARD_DELETE_YN" property="boardDeleteYn"/>
 		<result column="BOARD_VIEWS" property="boardViews"/>
 		<result column="BOARD_POST_DATE" property="boardDate"/>
 		<result column="STATE_CODE" property="stateCode"/>
 		<result column="STATE_NAME" property="stateName"/>
 		<result column="USER_CODE" property="userCode"/>
 		<result column="USER_NIKNAME" property="userNickname"/>
 		<result column="PICTURE_CODE" property="pictureCode"/>
 		<result column="PICTURE_DELETE_YN" property="pictureDeleteYN"/>
 		<result column="PICTURE_NEW_NAME" property="pictureNewName"/>
 		<result column="PICTURE_UTIL_PATH" property="pictureUtilPath"/>
 	</resultMap>
 	
 	<select id="selectTotalCount" resultType="int">
 		SELECT
		       COUNT(*)
		  FROM SHARE_BOARD S
		  JOIN USER_TABLE U ON (U.USER_CODE = S.USER_CODE)
		  JOIN SHARE_PICTURE_MANAGE SM ON(S.BOARD_CODE = SM.BOARD_CODE)
		  JOIN PICTURE_TABLE P ON(P.PICTURE_CODE = SM.PICTURE_CODE)
		 WHERE S.BOARD_DELETE_YN = 'N'
		   AND P.PICTURE_DELETE_YN = 'N'
 	</select>
 	
 	<select id="selectShareFreeList" parameterType="hashmap" resultMap="sharefreeResultMap">
 		SELECT *
		  FROM(
		        SELECT ROWNUM RN, R.*
		          FROM(
		                SELECT S.BOARD_CODE
		                     , S.BOARD_TITLE
		                     , S.BOARD_CONTENT
		                     , S.BOARD_DELETE_YN
		                     , S.BOARD_VIEWS
		                     , S.STATE_CODE
		                     , ST.STATE_NAME
		                     , U.USER_NIKNAME
		                     , P.PICTURE_UTIL_PATH
		                  FROM SHARE_BOARD S
		                  JOIN STATE_TABLE ST ON (ST.STATE_CODE = S.STATE_CODE)
		                  JOIN USER_TABLE U ON (U.USER_CODE = S.USER_CODE)
		                  JOIN SHARE_PICTURE_MANAGE SM ON(S.BOARD_CODE = SM.BOARD_CODE)
		                  JOIN PICTURE_TABLE P ON(P.PICTURE_CODE = SM.PICTURE_CODE)
		                 WHERE S.BOARD_DELETE_YN = 'N'
		                   AND P.PICTURE_DELETE_YN = 'N'
		                 ORDER BY S.BOARD_POST_DATE DESC
		                 )R
		            )
		    WHERE RN BETWEEN  #{pageInfo.start} AND #{pageInfo.end}
 	</select>
 </mapper>
