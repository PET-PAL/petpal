<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nobanryeo.petpal.user.mypage.dao.UserMapper">
	
	<resultMap id="userResultSet" type="UserInfoDTO">
		<id column="USER_CODE" property="code" />
		<result column="USER_ID" property="id" />
		<result column="USER_PWD" property="pwd" />
		<result column="USER_NAME" property="name" />
		<result column="USER_NIKNAME" property="nikname" />
		<result column="USER_PHONE" property="phone" />
		<result column="USER_EMAIL" property="email" />
		<result column="EMAIL_YN" property="emailYn" />
		<result column="REPLY_YN" property="replyYn" />
		<result column="WITHDRAW_YN" property="withdrawYn" />
		<result column="REPORT_COUNT" property="reportCount" />
		<result column="PERMISSON_SET" property="permisson" />
	</resultMap>
	
	<select id="selectUserIdcheck" resultType="string">
       SELECT
              COUNT(*)
         FROM USER_TABLE
        WHERE USER_ID = #{ id }
	</select>
	
	<select id="selectUserNickcheck" resultType="string">
       SELECT
              COUNT(*)
         FROM USER_TABLE
        WHERE USER_NIKNAME = #{ nikname }	
	</select>
	
	<select id="selectUserEmailcheck" resultType="string">
       SELECT
              COUNT(*)
         FROM USER_TABLE
        WHERE USER_EMAIL = #{ email }	
	</select>

	<insert id="insertUser" parameterType="UserInfoDTO">
	    INSERT 
           INTO USER_TABLE
           VALUES(
             USER_CODE_SEQ.NEXTVAL
           , #{ id }
           , #{ name }
           , #{ nikname }
           , #{ pwd }
           , #{ phone }
           , #{ email }
           , #{ emailYn }
           , #{ replyYn }
           , DEFAULT
           , DEFAULT
           , 1
           )
	</insert>
	
	<select id="selectUser" resultMap="userResultSet" parameterType="UserInfoDTO">
        SELECT 
               A.USER_CODE
             , A.USER_ID
             , A.USER_NAME
             , A.USER_NIKNAME
             , A.USER_PWD
             , A.USER_PHONE
             , A.USER_EMAIL
             , A.EMAIL_YN
             , A.REPLY_YN
             , A.WITHDRAW_YN
             , A.REPORT_COUNT
             , A.PERMISSON_SET
          FROM USER_TABLE A 
         WHERE A.USER_ID = #{ id }
	</select>
	
	<select id="selectUserPassword" resultType="string" parameterType="UserInfoDTO">
        SELECT 
               A.USER_PWD 
          FROM USER_TABLE A 
         WHERE A.USER_ID = #{ id } 
	</select>
	
	<select id="selectUserId" resultType="string" parameterType="UserInfoDTO">
        SELECT 
               A.USER_ID
          FROM USER_TABLE A 
         WHERE A.USER_EMAIL = #{ email } 
	</select>
	
	<update id="modifyPwd" parameterType="UserInfoDTO">
		UPDATE USER_TABLE 
           SET USER_PWD = #{ pwd } 
         WHERE USER_ID  = #{ id }
	</update>

 </mapper>

 
 
 
 
 
 
 
 
 
 